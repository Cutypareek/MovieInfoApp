<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home | Movies</title>
  <link rel="stylesheet" href="css/main.css" />


  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">


  <script src="app.js"></script>
</head>

<body>


  <!-- navbar -->
  <div class="nav navbar-expand-lg navbar-dark">
    <div class="nav__left">
      <img class="nav_logo" src="https://www.freeiconspng.com/thumbs/movie-icon/movie-icon-7.png" alt="">
    </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
      <ul class="navbar-nav ms-auto ">
        <li class="nav-item">
          <a class="nav-link" href="#">
          <div class="nav__mid ">
            <form id="movieForm" autocomplete="off">
              <div class="row" id="form">
                <div class="form-group input-movie col-lg-6">
                  
                  <input class="form-control" type="text" id="movieName" placeholder="Enter Movie...">
              </div>
            </div>
                <div class="form-group search col-lg-6">
                  <button class="btn btn-outline-light"  onclick="togglePopup_search()">
                    Search
                  </button>
                </div>
              </div>
            </form>
          </div>
        </a>
        </li>

    <li class="nav-item">
      <a class="nav-link" href="#">
        <div class="nav__list">
          
          <button class="btn btn-outline-light" onclick="togglePopup_mylist()">My list</button>
      
        </div>
      </a>
    </li>


    <li class="nav-item dropdown">
     
      <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <img src="/images/avatar.png" class="nav_avatar" alt=""> <script>document.write(localStorage.getItem('name'))</script>
      </a>
      
      <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
        <li><a class="dropdown-item" href="#" onclick="logout()">Sign Out</a></li>
      </ul>
    
    </li>
  

  </ul>
  
</div>
  
</div>

  <!-- banner -->
  <header id="banner">
    <div id="banner__contents" >
      <h1 id="banner__title"></h1>
      <div id="banner__buttons" >
        <button id="banner__button">Play</button>
        <button id="banner__button"><i class="fas"></i>My List</button>
      </div>
      <p id="banner__description"></p>
    </div>
    <div id="banner__fadeBottom"></div>
  </header>


<!-- Search button popup -->
  <div class="popup" id="popup-1">
    <div class="overlay"> </div>
    <div class="content">
      <div class="close-btn" onclick="togglePopup_search()">&times;
      </div>

      <div class="row">
        <div class="col-lg-6">
          <div id="result_img" >
          </div>
        </div> 
        <div class="col-lg-6">
          <div id="result_title" >
          </div>
          <label>Director:</label>
          <div id="result_dir" >
          </div>
          <label>Rating:</label>
          <div id="result_rate" >
          </div>
          <label>Year:</label>
          <div id="result_year" >
          </div>
          <label>Runtime:</label>
          <div id="result_runtime" >
          </div>
          <label>Plot:</label>
          <div id="result_plot" >
          </div>
        
        </div>
       </div>
      
      <button class="btn btn-outline-light btn-lg " id="list_btn" onclick=addtolist()>Add to My List</button>
      </div>

    </div>
  </div>


<!-- my list popup -->
  <div class="popup" id="popup-2">
    <div class="overlay"> </div>
    <div class="content">
      <div class="close-btn" onclick="togglePopup_mylist()">&times;
      </div>
      
        <div class="display">
          <!-- <script>document.write(localStorage.getItem('movie'));</script> -->
          <script>function display_list()
            {
              var arr= new Array();
              arr= JSON.parse(localStorage.getItem("movie"))?JSON.parse(localStorage.getItem("movie")):[];
              var len=arr.length;
              console.log(len);
              for(var i=0;i<arr.length;i++){
                document.write("Movie Name: ");
                document.write(arr[i].Movie +"<br/>");
                document.write("Plot: ");
                document.write(arr[i].Plot  +"<br/>");
                document.write("Year: ");
                document.write(arr[i].Year+ "<br/>");
                document.write("Rating: ");
                document.write(arr[i].Rating+ "<br/>");
                document.write("Runtime: ");
                document.write(arr[i].Runtime+ "<br/>");
                document.write("<br/>");
              }
                
            }
            display_list();</script>
        </div>


    </div>
  </div>


    <!-- row -->
    <div id="headrow">
      <div class="row">
        <h2 class="row__title"></h2>
        <div class="row__posters"></div>
      </div>
    </div>

    <script>
      window.addEventListener("scroll", function() {

        var nav = document.querySelector(".nav");
        nav.classList.toggle("active", window.scrollY > 0);
      })
    </script>

</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
  $(document).ready(function() {

    var apikey = "4b77489c"

    $("#movieForm").submit(function(event) {
      event.preventDefault()

      var movie = $("#movieName").val()

      var result = ""

      var url = "http://www.omdbapi.com/?apikey=" + apikey

      $.ajax({
        method: 'GET',
        url: url + "&t=" + movie,
        success: function(data) {
          result_img = `

          <img style="flex:left" width="220px" height='330px' src="${data.Poster}">
                      
                      `

          result_title=`${data.Title}`
          result_dir=`${data.Director}`
          result_rate= `${data.Rated}`
          result_year= `${data.Year}`
          result_runtime= `${data.Runtime}`
          result_plot=`${data.Plot}`
                      

          $("#result_img").html(result_img)
          $("#result_title").html(result_title)
          $("#result_dir").html(result_dir)
          $("#result_rate").html(result_rate)
          $("#result_year").html(result_year)
          $("#result_runtime").html(result_runtime)
          $("#result_plot").html(result_plot)
          
          
        }
      })
    })
  })
 
  // console.log(url);


  
  function togglePopup_search() {
    document.getElementById('popup-1').classList.toggle("active");
  }


  function togglePopup_mylist() {
    document.getElementById('popup-2').classList.toggle("active");
  }
  function addtolist(){
            
            let movie_info=new Array();
            movie_info= JSON.parse(localStorage.getItem("movie"))?JSON.parse(localStorage.getItem("movie")):[];

            if(movie_info.some( (v) => {return v.Movie==result_title} )){
                alert("Movie already added to list!")
            }
            else{
                movie_info.push({
                "Movie": result_title,
                "Plot": result_plot,
                "Year": result_year,
                "Rating": result_rate,
                "Runtime": result_runtime,
            })
            alert("Movie Added Successfully!")
            }
            
            localStorage.setItem('movie',JSON.stringify(movie_info));
  }
  function display_list()
            {
              var arr= new Array();
              arr= JSON.parse(localStorage.getItem("movie"))?JSON.parse(localStorage.getItem("movie")):[];
              var len=arr.length;
              console.log(len);
              for(var i=0;i<arr.length;i++){
                document.write("Movie Name: ");
                document.write(arr[i].Movie +"<br/>");
                document.write("Plot: ");
                document.write(arr[i].Plot  +"<br/>");
                document.write("Year: ");
                document.write(arr[i].Year+ "<br/>");
                document.write("Rating: ");
                document.write(arr[i].Rating+ "<br/>");
                document.write("Runtime: ");
                document.write(arr[i].Runtime+ "<br/>");
                document.write("<br/>");
              }
                
            }

</script>


<script>
  var name=localStorage.getItem('name')?localStorage.getItem('name'):'';
  if(name==''){
      alert("Please Login First");
      window.location.href="index.html";
  }
  

  function logout(){

      localStorage.removeItem('name');
      window.location.href="index.html";
  }
</script>


</html>
